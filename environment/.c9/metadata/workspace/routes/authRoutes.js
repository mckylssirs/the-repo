{"changed":false,"filter":false,"title":"authRoutes.js","tooltip":"/routes/authRoutes.js","value":"var express = require(\"express\");\nvar router = express.Router();\nvar bodyParser = require(\"body-parser\");\nvar user = require(\"../models/user.js\")\nvar passport = require(\"passport\")\nrouter.get(\"/register\",function(req,res){\n    var err = \"\";\n    res.render(\"authRoutes/register\", {error:err})\n})\nrouter.post(\"/register\", function(req, res){\n    user.register(new user({username: req.body.username}), req.body.password, function(err, user){\n        if(err){\n            console.log(err);\n            \n            return res.render(\"authRoutes/register\", {error:err});\n        }\n        passport.authenticate(\"local\")(req, res, function(){\n           res.redirect(\"/\");\n        });\n    });\n});\n\nrouter.get(\"/login\",function(req,res){\n    var err= \"\";\n    res.render(\"authRoutes/login\",{error:err})\n})\n\nrouter.post(\"/login\", passport.authenticate(\"local\", {\n    successRedirect: \"/\",\n    failureRedirect: \"/loginerr\"\n}) ,function(req,res){\n    \n})\nrouter.get(\"/loginerr\", function(req, res) {\n   var  err = \"UserError: Username or password is incorrect\";\n    res.render(\"authRoutes/login\", {error:err});\n})\nrouter.get(\"/logout\",function(req,res){\n    req.logout()\n    res.redirect(\"/\")\n})\nmodule.exports = router;","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":120,"scrollleft":0,"selection":{"start":{"row":20,"column":3},"end":{"row":20,"column":3},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":9,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1542640055000}